<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Brutto-Netto Rechner</title>
</head>

<body>

  <h1>Brutto-Netto Rechner</h1>

  <!-- Deine Eingaben -->
  <label>Bruttogehalt (€): <input id="brutto" type="number"></label>
  <label>Lohnsteuer (€): <input id="lst" type="number"></label>
  <label>Kirchensteuer-Satz (%): <input id="kist" type="number"></label>
  <label>VL-AG (€): <input id="vlag" type="number"></label>
  <label>VS (€): <input id="vs" type="number"></label>
  <label>Vorschuss (€): <input id="vorschuss" type="number"></label>

  <h3>SV-Anteil AN (%)</h3>
  <label>KV (%): <input id="kv" type="number"></label>
  <label>RV (%): <input id="rv" type="number"></label>
  <label>AV (%): <input id="av" type="number"></label>
  <label>PV (%): <input id="pv" type="number"></label>

  <button onclick="calcReal()">Berechnen</button>

  <div id="output"></div>

  <!-- ********* HIER KOMMT DAS SCRIPT REIN ********* -->
  <script>

    function euro(v) {
      return v.toFixed(2).replace('.', ',') + ' €';
    }

    function calcReal() {
      const brutto = parseFloat(document.getElementById('brutto').value || 0);
      const lst    = parseFloat(document.getElementById('lst').value || 0);
      const kist_s = parseFloat(document.getElementById('kist').value || 0);
      const vlag   = parseFloat(document.getElementById('vlag').value || 0);
      const vs     = parseFloat(document.getElementById('vs').value || 0);
      const vorsch = parseFloat(document.getElementById('vorschuss').value || 0);

      const kvp = parseFloat(document.getElementById('kv').value || 0);
      const rvp = parseFloat(document.getElementById('rv').value || 0);
      const avp = parseFloat(document.getElementById('av').value || 0);
      const pvp = parseFloat(document.getElementById('pv').value || 0);

      const svStart = brutto + vlag;

      // <<< BBG HIER >>>
      const KV_PV_BBG = 5512.5;
      const RV_AV_BBG = 8050.0;

      const kist = lst * (kist_s / 100);

      const kvBase = Math.min(svStart, KV_PV_BBG);
      const pvBase = kvBase;
      const rvBase = Math.min(svStart, RV_AV_BBG);
      const avBase = rvBase;

      const kv = kvBase * (kvp / 100);
      const rv = rvBase * (rvp / 100);
      const av = avBase * (avp / 100);
      const pv = pvBase * (pvp / 100);

      const steuerSv = lst + kist + kv + rv + av + pv;
      const gesamt   = steuerSv + vs + vorsch;
      const netto = svStart - gesamt;

      document.getElementById('output').innerHTML = `
        Nettogehalt: ${euro(netto)}<br>
        Gesamtabzüge: ${euro(gesamt)}
      `;
    }
  </script>

</body>
</html>
